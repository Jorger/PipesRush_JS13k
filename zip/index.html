<link rel="icon" type="image/png" href="icon.png" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Pipes Rush</title><meta name=theme-color content=#000><link rel=manifest href=m.json><style>*{margin:0;padding:0}@keyframes s{from{transform:translate3d(-100%,0,0)}to{transform:translate3d(0,0,0)}}.s{animation-duration:.6s;animation-fill-mode:both;animation-name:s}html,body{font-family:Arial;overflow:hidden;height:100%;user-select:none;background-color:#000}#f{display:flex;height:100%}#c{margin:auto;position:relative}#g{box-sizing:border-box}#t,#a{user-select:none;outline:0;-webkit-tap-highlight-color:#ffffff00;display:block;position:relative;margin:0 auto;background:linear-gradient(#fff 50%,#ffffff00 0) 0 0,radial-gradient(circle closest-side,#fff 53%,#ffffff00 0) 0 0,radial-gradient(circle closest-side,#fff 50%,#ffffff00 0) 55px 0 #394651;background-size:110px 200px;background-repeat:repeat-x;width:320px;height:568px;box-sizing:border-box}#a,#m{cursor:pointer}#s{display:none}#m{background:#fff;box-sizing:border-box;display:none;position:absolute;padding:20px;bottom:0;text-align:center;z-index:1;width:100%;font-size:1.3em}#l{perspective:1000px}#l,#b{width:320px;height:568px}#p{transition:.6s;transform-style:preserve-3d;position:relative}#t,#b{backface-visibility:hidden;position:absolute;top:0;left:0;z-index:2}#b{transform:rotateY(180deg);background:#f8f8f8}.i{transform:rotateY(180deg)}#u{text-align:center;padding:35px 0;font-size:2.5em}#o{margin-top:20px;overflow-y:auto;height:427px}#w{padding-left:18px;padding-bottom:15px;display:flex;flex-wrap:wrap}#w>div{background-color:#f1f1f1;border-radius:5px;width:50px;height:50px;margin:10px;text-align:center;line-height:50px;font-size:30px;cursor:pointer}.q{color:silver}</style><div id=f><div id=c><div id=l><div id=p><div id=t><div id=u>Pipes Rush</div><div id=o><div id=w></div></div></div><div id=b><div id=g><div id=m class=s></div><canvas id=a width=320 height=568></canvas><canvas id=s width=100 height=100></canvas></div></div></div></div></div></div><script>function Sf(){this.sS=function(e){for(var t=0;t<24;t++)this[String.fromCharCode(97+t)]=e[t]||0;this.c<.01&&(this.c=.01);var n=this.b+this.c+this.e;if(n<.18){var A=.18/n;this.b*=A,this.c*=A,this.e*=A}}}function Sx(){var e,t,n,A,r,s,o,i,l,a,c,f;this._p=new Sf,this.r=function(){var e=this._p;A=100/(e.f*e.f+.001),r=100/(e.g*e.g+.001),s=1-e.h*e.h*e.h*.01,o=-e.i*e.i*e.i*1e-6,e.a||(c=.5-e.n/2,f=5e-5*-e.o),i=1+e.l*e.l*(e.l>0?-.9:10),l=0,a=1==e.m?0:(1-e.m)*(1-e.m)*2e4+32},this.t=function(){this.r();var A=this._p;return e=A.b*A.b*1e5,t=A.c*A.c*1e5,n=A.e*A.e*1e5+12,3*((e+t+n)/3|0)},this.W=function(h,d){var g=this._p,p=1!=g.s||g.v,u=g.v*g.v*.1,w=1+3e-4*g.w,m=g.s*g.s*g.s*.1,v=1+1e-4*g.t,b=1!=g.s,x=g.x*g.x,S=g.g,B=g.q||g.r,M=g.r*g.r*g.r*.2,L=g.q*g.q*(g.q<0?-1020:1020),E=g.p?32+((1-g.p)*(1-g.p)*2e4|0):0,k=g.d,y=g.j/2,O=g.k*g.k*.01,R=g.a,U=e,C=1/e,D=1/t,I=1/n,T=5/(1+g.u*g.u*20)*(.01+m);T>.8&&(T=.8),T=1-T;for(var G,P,V,q,z,H,F=!1,j=0,Q=0,X=0,N=0,W=0,K=0,Y=0,J=0,Z=0,_=0,$=new Array(1024),ee=new Array(32),te=$.length;te--;)$[te]=0;for(te=ee.length;te--;)ee[te]=2*Math.random()-1;for(te=0;te<d;te++){if(F)return te;if(E&&++Z>=E&&(Z=0,this.r()),a&&++l>=a&&(a=0,A*=i),(A*=s+=o)>r&&(A=r,S>0&&(F=!0)),P=A,y>0&&(_+=O,P*=1+Math.sin(_)*y),(P|=0)<8&&(P=8),R||((c+=f)<0?c=0:c>.5&&(c=.5)),++Q>U)switch(Q=0,++j){case 1:U=t;break;case 2:U=n}switch(j){case 0:X=Q*C;break;case 1:X=1+2*(1-Q*D)*k;break;case 2:X=1-Q*I;break;case 3:X=0,F=!0}B&&((V=0|(L+=M))<0?V=-V:V>1023&&(V=1023)),p&&w&&((u*=w)<1e-5?u=1e-5:u>.1&&(u=.1)),H=0;for(var ne=8;ne--;){if(++Y>=P&&(Y%=P,3==R))for(var Ae=ee.length;Ae--;)ee[Ae]=2*Math.random()-1;switch(R){case 0:z=Y/P<c?.5:-.5;break;case 1:z=1-Y/P*2;break;case 2:z=.225*(((z=1.27323954*(q=6.28318531*((q=Y/P)>.5?q-1:q))+.405284735*q*q*(q<0?1:-1))<0?-1:1)*z*z-z)+z;break;case 3:z=ee[Math.abs(32*Y/P|0)]}p&&(G=K,(m*=v)<0?m=0:m>.1&&(m=.1),b?(W+=(z-K)*m,W*=T):(K=z,W=0),N+=(K+=W)-G,z=N*=1-u),B&&($[J%1024]=z,z+=$[(J-V+1024)%1024],J++),H+=z}H*=.125*X*x,h[te]=H>=1?32767:H<=-1?-32768:32767*H|0}return d}}var synth=new Sx;window.jsfxr=function(e){synth._p.sS(e);var t=synth.t(),n=new Uint8Array(4*((t+1)/2|0)+44),A=2*synth.W(new Uint16Array(n.buffer,44),t),r=new Uint32Array(n.buffer,0,44);r[0]=1179011410,r[1]=A+36,r[2]=1163280727,r[3]=544501094,r[4]=16,r[5]=65537,r[6]=44100,r[7]=88200,r[8]=1048578,r[9]=1635017060,r[10]=A,A+=44;for(var s=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="data:audio/wav;base64,";s<A;s+=3){var l=n[s]<<16|n[s+1]<<8|n[s+2];i+=o[l>>18]+o[l>>12&63]+o[l>>6&63]+o[63&l]}return i},function(){const e=document.querySelector.bind(document),t=document.querySelectorAll.bind(document),n=320,A=568,r=e("#a"),s=e("#s"),o=e("#m"),i=r.getContext("2d"),l=s.getContext("2d"),a=10,c=170,f={t:0,p:0,f:!1},h=[0,90,180,270],d=["#e65166","#8cdb40","#03a9f4"],g=""!==location.search&&location.search.split("?")[1].toLowerCase().indexOf("pwa")>=0;let p="onLine"in navigator&&navigator.onLine,u=[];const w=[{b:"iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAABlBMVEWSuvFHcEy05ID4AAAAAnRSTlPvAK91IhsAAABDSURBVHgBY/gPAR8GCwOEGSGMBwwM9bgZUF0/Ydp/wBgf6qGMBzDGAXsoo0EeymDghzD+MbBDGH8YmEcs4wcDI1YGAMuCiVirwxXPAAAAAElFTkSuQmCC",i:""},{b:"iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAABlBMVEWTu/LC2PVj8DGhAAAAAnRSTlP9A06IA3IAAABsSURBVHgBtdE3AQMxDIXhP300hEAxtARaoBiCtvSr7mX0afomtcdoS7YFyuLFzkLA4gF6xR2uKwC1YAAuC37AwWO34JWCBdLGbYbpDalQT39lq2ZXDBb20ouHyp9gQOeP+nGwGLh0wiELpcIEClk1RxVgs/gAAAAASUVORK5CYII=",i:""},{b:"iVBORw0KGgoAAAANSUhEUgAAADwAAAA8BAMAAADI0sRBAAAAMFBMVEUAAADj7/Ln8fTg7fDl7/Pf6+7k7/Lf7O/n8fTr8vXn8PPp6+rf6u3t8/Pk7vH09fUMUbgxAAAAC3RSTlMAgBvj5vHAjm8OSkX7KI8AAAC5SURBVDjLYxgFo4BeQEkTt9wkJQZjD9zSLcYMZ44J4gQ5ZxjO4AOUSr97sxsnOPeO4e4d3NJn7zL8xyf9n+H/H9zS50HS+HQTsJuANAGPIQfLaYjgHlyhBpFGDdSjxjAQcxqsGUkAKH1cCQZqwNLIAmcYXKzgsS9zBix9EC6w2IVBSQG3NJMSkMCURoBR6WEg/RC77IycM2fe7Xtz5lknVmmVM2fe3v9778wZJ5zS/0HSRrh1/0eVBgBC4ci5mcMCBAAAAABJRU5ErkJggg==",i:""},{b:"iVBORw0KGgoAAAANSUhEUgAAADwAAAA8BAMAAADI0sRBAAAAGFBMVEUAAADh7vLl8PPn8vXk8PTi7vPq7Ozf6+29FmGyAAAABnRSTlMA6YcbUbBDXr+1AAAA7UlEQVQ4y+3TPQ6CQBAFYCJ6AAOGVsHEdv05gN5AExNvsNRrgu/6PmAxRmemsLDitV/ezBAgGTPmXynXJuNuc1jvLUaYl85gZlGZzA0K+9r71q86+5peqczQjwbTF85gzr/qTOd4gzk+l57bD2FdYDxe43OBGb3ON0JX67gfVsXgaNwHl1WSnoq4H1h+H08HlOm9X4Z6k0iZFrEejqKf+nqNzKzzw7XqCM6qc7lS7xlnmWdxei5zWnSs/lQbWLcl2365xhMuJ/OtKI9mcho5U267dadrnG4AKjInX959MzVCJjPLLeMn3pUxb3/6E/omkHsWjxRgAAAAAElFTkSuQmCC",i:""},{b:"iVBORw0KGgoAAAANSUhEUgAAADwAAAA8BAMAAADI0sRBAAAALVBMVEUAAADk8PPd6vDm8fXh7vLk7/Lh7vLi7/Lo8fXq8vXq6urg6+3z9fXq8fLZ6ezMwlrKAAAACnRSTlMAgIAb5b7Vbw5IfuxIFwAAAFZJREFUOMtjQACTd7v3njlzdvc+ZwZswGQfXmkzqPTuZKzSzNG7wWDrBAasQHv3KiDYvZFhVHpUelR6VHpUelSaPOl2YFWzdy+wqqnAW4+9I1TNEa0bAMljN0Mee7XmAAAAAElFTkSuQmCC",i:""}];let m,v=[],b=[],x=0,S=+localStorage.getItem("pipe")||1,B=!1,M=[],L=!1;r.width=n,r.height=A,r.style.width=n+"px",r.style.height=A+"px",o.addEventListener("click",()=>{f.f?e("#p").classList.remove("i"):D(x+1),q(!1)});const E=(e,t)=>{const n=b[1][e];i.save(),l.clearRect(0,0,100,100),l.drawImage(w[n[2]-1].i,0,0,t,t),""!==n[4]&&(l.globalCompositeOperation="source-atop",l.fillStyle=n[4],l.fillRect(0,0,t,t)),i.translate(a+t*n[1]+t/2,c+t*n[0]+t/2);let A=h[n[3]];if(n[3]!==n[5]){const t=M.map(e=>e[0]).indexOf(e);if(t>=0){const r=0===h[n[5]]?360:h[n[5]];M[t][1]+10<=r?(M[t][1]+=15,A=M[t][1]):(A=r,M.splice(t,1),b[1][e][3]=n[5],k())}}i.rotate(A*Math.PI/180),i.translate(-t/2,-t/2),i.drawImage(s,0,0),l.globalCompositeOperation="source-over",i.restore()},k=()=>{const e=[[[1,0],[0,-1],[-1,0],[0,1]],[[[2,0,-1,1,0,1,3],[3,1,0,0,0,1,3],[1,1,0,0,0,-1,1]],[[3,-1,0,2,1,0,0],[2,0,-1,1,-1,0,2],[0,0,-1,1,1,0,0]],[[0,0,-1,1,0,1,3],[3,-1,0,2,0,1,3],[1,-1,0,2,0,-1,1]],[[1,-1,0,2,1,0,0],[0,0,1,3,1,0,0],[2,0,1,3,-1,0,2]]],[[[2,0,-1,1],[3,1,0,0]],[[0,0,-1,1],[3,-1,0,2]],[[0,0,1,3],[1,-1,0,2]],[[1,1,0,0],[2,0,1,3]]]];for(let e=0;e<b[1].length;e++)1!==b[1][e][2]&&2!==b[1][e][2]&&(b[1][e][4]="");const t=[],n=b[2].map(e=>[e,0]);for(let A=0;A<b[2].length;A++){const r=b[2][A];if(t.indexOf(r)<0){const s=[],o=[];s.push(r),o.push([r,b[1][r][3]]),t.push(r);let i=b[1][r][4];for(;o.length>0;){const[A,r]=o.pop(),l=b[1][A][2];let a=2!==l;if(a&&1===l&&(a=r===b[1][A][3]),a){const n=1===l||4===l||5===l?1:2;let i=[];if(3===l||4===l){i=e[3===l?1:2][b[1][A][3]].filter(e=>e[0]===r)[0]}for(let a=0;a<n;a++){const n=1===l||5===l?e[0][r][0]:i[3*a+1],c=1===l||5===l?e[0][r][1]:i[3*a+2],f=1===l||5===l?r:i[3*a+3],h=y(O(b[1][A][0]+n,b[1][A][1]+c),f);h>=0&&(s.indexOf(h)>=0||(o.push([h,f]),s.push(h),t.indexOf(h)<0&&t.push(h)))}}else if(1===l&&i!==b[1][A][4]){i=V(G(P(i),P(b[1][A][4])));const e=b[3].filter(e=>b[1][e][4]===i).length;if(0!==e){const t=n.map(e=>e[0]).indexOf(A);t>=0&&(n[t][1]=e)}}}let l=0;for(let e of s)1!==b[1][e][2]&&2!==b[1][e][2]?b[1][e][4]=i:2===b[1][e][2]&&b[1][e][4]===i&&l++;n[A][1]=l,u[A][1]!==n[A][1]&&(H(0===n[A][1]?[1,,.3638,,.3833,.2098,,.3143,,,,,,,,.403,,,1,,,,,.63]:[2,,.1674,,.2436,.7636,.0377,-.3541,,,,,,.4824,.0035,,.169,-.0485,1,,,,,.55]),u[A][1]=n[A][1])}}if(t.length===b[1].length){n.reduce((e,t)=>e+(0!==t[1]),0)===b[2].length&&(L=!0,q(!0,"Next Level"))}},y=(e,t)=>{let n=-1;const A=[[[2],[2],[1,2,3],[1,2],[0,2]],[[3],[3],[0,2,3],[2,3],[1,3]],[[0],[0],[0,1,3],[0,3],[0,2]],[[1],[1],[0,1,2],[0,1],[1,3]]][t];if(0!==e.length)for(let t of e){if(A[b[1][t][2]-1].indexOf(b[1][t][3])>=0){n=t;break}}return n},O=(e,t)=>{const n=[];if(e>=0&&e<b[0]&&t>=0&&t<b[0])for(let A=0;A<b[1].length&&(b[1][A][0]!==e||b[1][A][1]!==t||(n.push(A),(4===b[1][A][2]||5===b[1][A][2])&&2!==n.length));A++);return n},R=(e,t,n)=>{i.beginPath(),i.rect(e,t,n,n),i.fillStyle="#435563",i.fill(),i.lineWidth=1,i.strokeStyle="#394651",i.stroke()},U=e=>e.map((e,t)=>4!==t?+e:e);(e=>{let t=0;w.forEach((n,A)=>{const r=new Image;r.onload=(()=>{w[+r.id].i=r,++t===w.length&&e()}),r.src=`data:image/png;base64,${n.b}`,r.id=A})})(()=>{fetch("w.txt").then(e=>e.text()).then(e=>{v=(e=>{const t=[],n=e.split(";");for(let e of n){const n=e.split("#"),A=n[0].split(","),r=n[1],s={s:[],e:[]},o=[];let i=0,l=0;for(let e=0;e<r.length/4;e++){const t=r.substr(4*e,4).split("");let n="";if(1==+t[2]||2==+t[2]){const e=A[i+1];if(e.indexOf("-")>=0){const t=e.split("-");n=d[+t[0]-1];for(let e=1;e<t.length;e++)n=V(G(P(n),P(d[+t[e]-1])))}else n=d[+e-1];i++,s[1==+t[2]?"s":"e"].push(l)}if(t.push(n,t[3]),6==+t[2]||7==+t[2]){const e=+t[2],n=+t[3];t[2]=6===e?5:4;const A=[...t];A[3]=6===e?+!n:[2,3,0,1][n],o.push(U(t),U(A)),l++}else o.push(U(t));l++}t.push([+A[0],o,s.s,s.e])}return t})(e),C()})});const C=()=>{const n=e("#w");for(let e=1;e<=v.length;e++){const t=document.createElement("div");t.innerHTML=e,t.className="e"+(e<=S?"":" q"),t.dataset.index=e,n.appendChild(t)}[...t(".e")].forEach(t=>{t.addEventListener("click",t=>{const{index:n}=t.currentTarget.dataset;+n<=S&&(e("#p").classList.add("i"),D(+n),B=!0,z())})})},D=(e=1)=>{x=e<=v.length?e:1,f.p=100,f.t=0,f.f=!1,b=JSON.parse(JSON.stringify(v[x-1])),u=b[2].map(e=>[e,0]),k(),L=!1,x>=S&&(S=x,localStorage.setItem("pipe",S),t(".e")[x-1].classList.remove("q"))},I=e=>{b[1][e][5]=b[1][e][3]+1>=4?0:b[1][e][3]+1,M.push([e,h[b[1][e][3]]])};((e,t,...n)=>{for(let A=0;A<n.length;A++)e.addEventListener(n[A],t,!1)})(r,e=>{e.stopPropagation(),e.preventDefault();let t=e;"touchstart"===e.type&&(t=e.touches[0]||e.changedTouches[0]);const r=Math.floor(t.pageX)-(window.innerWidth-n)/2,s=Math.floor(t.pageY)-(window.innerHeight-A)/2;L||f.f||((e,t)=>{let A=-1;const r=b[0],s=Math.round((n-2*a)/r),o=b[1];for(let n=0;n<o.length;n++){const r={x:{start:a+s*o[n][1],end:a+s*o[n][1]+s},y:{start:c+s*o[n][0],end:c+s*o[n][0]+s}},i={x:e>r.x.start&&e<r.x.end,y:t>r.y.start&&t<r.y.end};if(i.x&&i.y){A=n;break}}if(A>=0&&1!==o[A][2]&&2!==o[A][2]&&!(M.map(e=>e[0]).indexOf(A)>=0)&&(H([0,,.1923,,.2442,.3415,,.2591,,,,,,.4507,,,,,.4341,,,,,.5]),I(A),5===o[A][2]||4===o[A][2]))for(let e=0;e<o.length;e++)if(e!==A&&o[A][0]===o[e][0]&&o[A][1]===o[e][1]&&o[A][2]===o[e][2]){I(e);break}})(r,s)},"mousedown","touchstart");const T=(e,t,n)=>parseInt(e*n+t*(1-n)),G=(e,t,n=.5)=>[T(e[0],t[0],n),T(e[1],t[1],n),T(e[2],t[2],n)],P=e=>e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,n,A)=>"#"+t+t+n+n+A+A).substring(1).match(/.{2}/g).map(e=>parseInt(e,16)),V=e=>"#"+e.map(e=>{const t=e.toString(16);return 1===t.length?"0"+t:t}).join(""),q=(e,t="")=>{o.style.display=e?"block":"none",""!==t&&(o.innerHTML=t)},z=()=>{m=requestAnimationFrame(z),B?(()=>{i.clearRect(0,0,window.innerWidth,window.innerHeight);const e=b[0],t=Math.round((n-2*a)/e);i.font="bold 15px Arial",i.fillStyle=p?"silver":"#8cdb40",i.fillText("OFFLINE"+(p?"":" (+40)"),10,30),i.fillStyle=g?"red":"silver",i.fillText((g?"(+20) ":"")+"PWA",g?230:260,30),i.font="bold 50px Arial",i.fillStyle="#394651",i.fillText(`${x<=9?`0${x}`:x}`,135,80),i.beginPath(),i.lineWidth=15,i.strokeStyle="#fbc459",i.moveTo(0,A-15),i.lineTo(n*(f.p/100),A-15),i.stroke(),f.t++,f.t>=50+(p?0:40)+(g?20:0)&&!f.f&&!L&&(f.t=0,f.p--,f.p<=0&&(f.f=!0,B=!1,q(!0,"Game Over :(")));for(let n=0;n<e;n++)for(let A=0;A<e;A++)R(a+t*A,c+t*n,t);for(let e=0;e<b[1].length;e++)E(e,t)})():cancelAnimationFrame(m)};document.addEventListener("contextmenu",e=>e.preventDefault());const H=e=>{let t=window.URL||window.webkitURL;try{let n=jsfxr(e),A=new Audio;A.addEventListener("error",function(){console.log("Error: "+A.error.code)},!1),A.src=n,A.play(),A.addEventListener("ended",function(e){t.revokeObjectURL(n)},!1)}catch(e){console.log(e.message)}};window.addEventListener("offline",()=>{p=!1}),window.addEventListener("online",()=>{p=!0}),console.log("%c%s","color: black; font-size: 24px;","Developed by Jorge Rubiano https://twitter.com/ostjh")}();"serviceWorker" in navigator&&(navigator.serviceWorker.register("/sw.js").then(function(){console.log("SW Registered")}),navigator.serviceWorker.ready.then(function(){console.log("SW Ready")}));</script>